{"version":3,"sources":["pos.js"],"names":["add_invoice_item","item","count","spositems","item_id","Settings","item_addition","id","row","qty","parseFloat","store","JSON","stringify","loadItems","get","total","an","product_tax","invoice_tax","product_discount","order_discount","total_discount","$","empty","time","Date","getTime","remote_printing","ob_info","pos_customer","text","hr","val","user","username","pos_curr_time","date","dateformat","timeformat","order_data","info","bill_data","o_items","b_items","style","pos_head","site_name","prepend","lang","order","bill","parse","each","this","product_id","item_type","type","item_tax_method","tax_method","combo_items","item_qty","item_aqty","quantity","item_ds","discount","item_code","code","item_name","name","replace","net_price","real_unit_price","item_comment","comment","item_was_ordered","ordered","ds","item_discount","formatDecimal","indexOf","pds","split","isNaN","pr_tax","parseInt","tax","pr_tax_val","inclusive","exclusive","row_no","newTr","tr_html","formatMoney","html","prependTo","oitb","scrollHeight","slimScroll","scrollTo","addClass","find","removeClass","comments","i","len","length","printLine","bprTr","oprTr","append","ts","order_tax","pts","g_total","grand_total","items","b_totals","rounding","round_total","roundNumber","total_payable","total_items","totals","bill_totals","merchant_copy","display_kb","display_keyboards","focus","chr","String","fromCharCode","jQuery","browser","mobile","keyboard","autoAccept","alwaysOpen","openOn","usePreview","layout","display","bksp","accept","default","meta1","meta2","customLayout","shift","restrictInput","preventPaste","b","calTax","nav_pointer","pp","p_page","attr","pro_limit","tcp","Popup","data","mywindow","window","open","document","write","assets","print","close","posScreen","wh","height","total_dh","buttons_dh","items_dh","list_table_dh","outerHeight","str","size","char_per_line","res","newd","read_card","ready","on","e","preventDefault","stopPropagation","hideseek","nodata","no_match_found","n","modal","closest","unit_price","base_url","label","row_id","backdrop","price","is_valid_discount","bootbox","alert","unexpected_value","localStorage","setItem","is_numeric","new_qty","click","protect_delete","dialog","title","enter_pin_code","closeButton","message","buttons","danger","className","callback","success","delete","md5","pin_code","remove","location","href","wrong_pin","keypress","keyCode","trigger","confirm","r_u_sure","result","please_add_product","show","print_img","html2canvas","onrendered","canvas","img","toDataURL","post","spos_token","csrf_hash","form","serialize","printOrder","setTimeout","hide","printBill","apply_to","dval","focusToEnd","tval","ajax","url","dataType","cid","cat_id","category_id","products","per_page","autocomplete","source","minLength","autoFocus","delay","response","event","ui","content","_trigger","select","bind","inputmask","placeholder","no","generateCardNo","parent","children","gccode","gcname","gcvalue","gcprice","gcexpiry","file_required_fields","gc_data","Array","gcdata","hasOwnProperty","ref","type_reference_note","suspend","sid","appendTo","submit","gtotal","change","total_paying","total_paid","p_val","rounded_total","slideDown","slideUp","cn","async","balance","incorrect_gift_card","card_no","value","paying","$quick_cash","amt","contents","filter","nodeType","th","thousands_sep","$pi","join","note_count","spos_note","spos_customer","select2","hover","top","offset","menu","target","hasClass","hold_ref","status","msg","error","customer_request_failed","start","width","extend","keyaction","enter","base","$el","is","insertText","TrackData","p","SwipeParserObj","hasTrack1","CardType","ccn1","account","charAt","account_name","exp_month","exp_year","blur","removeData","clear","reload","focus_add_item","shortcut","add","propagate","add_customer","toggle_category_slider","cancel_sale","suspend_sale","print_order","print_bill","finalize_sale","today_sale","open_hold_bills","close_register","fn","v","ajaxSetup","cache","headers","cache-control"],"mappings":"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","file":"../pos.min.js","sourcesContent":["function add_invoice_item(item) {\n\n    if (count == 1) {\n        spositems = {};\n    }\n    if (item == null) {\n        return;\n    }\n\n    var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n    if (spositems[item_id]) {\n        spositems[item_id].row.qty = parseFloat(spositems[item_id].row.qty) + 1;\n    } else {\n        spositems[item_id] = item;\n    }\n\n    store('spositems', JSON.stringify(spositems));\n    loadItems();\n    return true;\n}\n\nfunction loadItems() {\n    if (count == 1) {\n        spositems = {};\n    }\n    if (get('spositems')) {\n        total = 0;\n        count = 1;\n        an = 1;\n        product_tax = 0;\n        invoice_tax = 0;\n        product_discount = 0;\n        order_discount = 0;\n        total_discount = 0;\n\n        $(\"#posTable tbody\").empty();\n        var time = ((new Date).getTime())/1000;\n        if (Settings.remote_printing != 1) {\n\n            var pos_customer = 'C: '+$('#select2-spos_customer-container').text()+ \"\\n\";\n            var hr = 'R: '+$('#hold_ref').val()+ \"\\n\";\n            var user = 'U: '+username+ \"\\n\";\n            var pos_curr_time = 'T: '+date(Settings.dateformat+' '+Settings.timeformat, time)+ \"\\n\";\n            var ob_info = pos_customer+hr+user+pos_curr_time+ \"\\n\";\n            order_data.info = ob_info;\n            bill_data.info = ob_info;\n            var o_items = '';\n            var b_items = '';\n\n        } else {\n            $(\"#order_span\").empty(); $(\"#bill_span\").empty();\n            var style = '<style>.bb td, .bb th { border-bottom: 1px solid #DDD; }</style>';\n            var pos_head = '<span style=\"text-align:center;\"><h3>'+Settings.site_name+'</h3>'\n            // var pos_customer = ''; // remove this line and uncomment below to display customer\n            var pos_customer = '<h5>C: '+$('#select2-spos_customer-container').text()+'</h5>';\n            var hr = '<h5>R: '+$('#hold_ref').val()+'</h5>';\n            var user = '<h5>U: '+username+'</h5>';\n            var pos_curr_time = '<h5>T: '+date(Settings.dateformat+' '+Settings.timeformat, time)+'</h5>';\n            $(\"#order_span\").prepend(style+pos_head+'<h4>'+lang.order+'</h4></span>'+pos_customer+hr+user+pos_curr_time);\n            $(\"#bill_span\").prepend(style+pos_head+'<h4>'+lang.bill+'</h4></span>'+pos_customer+hr+user+pos_curr_time);\n            $(\"#order-table\").empty(); $(\"#bill-table\").empty();\n        }\n        spositems = JSON.parse(get('spositems'));\n\n        $.each(spositems, function () {\n\n            var item = this;\n            var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n            spositems[item_id] = item;\n\n            var product_id = item.row.id, item_type = item.row.type, item_tax_method = parseFloat(item.row.tax_method), combo_items = item.combo_items, item_qty = item.row.qty, item_aqty = parseFloat(item.row.quantity), item_type = item.row.type, item_ds = item.row.discount, item_code = item.row.code, item_name = item.row.name.replace(/\"/g, \"&#034;\").replace(/'/g, \"&#039;\");\n            var unit_price = parseFloat(item.row.real_unit_price);\n            var net_price = unit_price;\n            var item_comment = item.row.comment;\n            var item_was_ordered = item.row.ordered ? item.row.ordered : 0;\n\n            var ds = item_ds ? item_ds : '0';\n            var item_discount = formatDecimal(ds);\n            if (ds.indexOf(\"%\") !== -1) {\n                var pds = ds.split(\"%\");\n                if (!isNaN(pds[0])) {\n                    item_discount = formatDecimal(parseFloat(((net_price) * parseFloat(pds[0])) / 100));\n                }\n            }\n            product_discount += formatDecimal(item_discount * item_qty);\n            net_price = formatDecimal(net_price-item_discount);\n\n            var pr_tax = parseInt(item.row.tax), pr_tax_val = 0;\n            if (pr_tax !== null && pr_tax != 0) {\n                if(item_tax_method == 0) {\n                    pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100+parseFloat(pr_tax)));\n                    net_price -= pr_tax_val;\n                    tax = lang.inclusive;\n                } else {\n                    pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                    tax = lang.exclusive;\n                }\n            }\n            product_tax += formatDecimal(pr_tax_val * item_qty);\n\n            var row_no = (new Date).getTime();\n            var newTr = $('<tr id=\"' + row_no + '\" class=\"' + item_id + '\" data-item-id=\"' + item_id + '\"></tr>');\n            tr_html = '<td><input name=\"product_id[]\" type=\"hidden\" class=\"rid\" value=\"' + product_id + '\"><input name=\"item_comment[]\" type=\"hidden\" class=\"ritem_comment\" value=\"' + item_comment + '\"><input name=\"product_code[]\" type=\"hidden\" value=\"' + item.row.code + '\"><input name=\"product_name[]\" type=\"hidden\" value=\"' + item.row.name + '\"><button type=\"button\" class=\"btn bg-purple btn-block btn-xs edit\" id=\"' + row_no + '\" data-item=\"' + item_id + '\"><span class=\"sname\" id=\"name_' + row_no + '\">' + item_name + ' (' + item_code + ')</span></button></td>';\n            // <input class=\"rprice\" name=\"net_price[]\" type=\"hidden\" id=\"price_' + row_no + '\" value=\"' + formatDecimal(item_price) + '\">\n            tr_html += '<td class=\"text-right\"><input class=\"realuprice\" name=\"real_unit_price[]\" type=\"hidden\" value=\"' + item.row.real_unit_price + '\"><input class=\"rdiscount\" name=\"product_discount[]\" type=\"hidden\" id=\"discount_' + row_no + '\" value=\"' + ds + '\"><span class=\"text-right sprice\" id=\"sprice_' + row_no + '\">' + formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) + '</span></td>';\n            tr_html += '<td><input name=\"item_was_ordered[]\" type=\"hidden\" class=\"riwo\" value=\"' + item_was_ordered + '\"><input class=\"form-control input-qty kb-pad text-center rquantity\" name=\"quantity[]\" type=\"text\" value=\"' + formatDecimal(item_qty) + '\" data-id=\"' + row_no + '\" data-item=\"' + item_id + '\" id=\"quantity_' + row_no + '\" onClick=\"this.select();\"></td>';\n            tr_html += '<td class=\"text-right\"><span class=\"text-right ssubtotal\" id=\"subtotal_' + row_no + '\">' + formatMoney(((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty))) + '</span></td>';\n            tr_html += '<td class=\"text-center\"><i class=\"fa fa-trash-o tip pointer posdel\" id=\"' + row_no + '\" title=\"Remove\"></i></td>';\n            newTr.html(tr_html);\n            newTr.prependTo(\"#posTable\");\n            total += formatDecimal((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty));\n            count += parseFloat(item_qty);\n            an++;\n            // $('#list-table-div').scrollTop(0);\n            var oitb = $('#list-table-div')[0].scrollHeight;\n            $('#list-table-div').slimScroll({scrollTo: oitb});\n            if(item_type == 'standard' && item_qty > item_aqty) {\n                $('#' + row_no).addClass('danger');\n                $('#' + row_no).find('.edit').removeClass('bg-purple').addClass('btn-warning');\n            }\n            else if (item_type == 'combo') {\n                if(combo_items === false) {\n                    $('#' + row_no).addClass('danger');\n                } else {\n                    $.each(combo_items, function(){\n                        if(parseFloat(this.quantity) < (parseFloat(this.qty)*item_qty)) {\n                            $('#' + row_no).addClass('danger');\n                            $('#' + row_no).find('.edit').removeClass('bg-purple').addClass('btn-warning');\n                        }\n                    });\n                }\n            }\n\n            var comments = item_comment ? item_comment.split(/\\r?\\n/g) : [];\n            if (Settings.remote_printing != 1) {\n\n                b_items += \"#\"+(an-1)+\" \"+ item_name + \" (\" + item_code + \")\" + \"\\n\";\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    b_items += (comments[i].length > 0 ? \"   * \"+comments[i]+\"\\n\" : \"\");\n                }\n                b_items += printLine(item_qty + \" x \" + formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val))+\": \"+ formatMoney(((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty)))) + \"\\n\";\n                o_items += printLine(\"#\"+(an-1)+\" \"+ item_name + \" (\" + item_code + \"): [ \"+ (item_was_ordered != 0 ? 'xxxx' : item_qty)) + \" ]\\n\";\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    o_items += (comments[i].length > 0 ? \"   * \"+comments[i]+\"\\n\" : \"\");\n                }\n                o_items += \"\\n\";\n\n            } else {\n                var bprTr = '<tr class=\"row_' + item_id + '\" data-item-id=\"' + item_id + '\"><td colspan=\"2\">#'+(an-1)+' '+ (item_id == 0 ? item.row.name :item_name + ' (' + item_code + ')');\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    bprTr += (comments[i] ? '<br> <b>*</b> <small>'+comments[i]+'</small>' : '');\n                }\n                bprTr += '</td></tr>';\n                bprTr += '<tr class=\"bb row_' + item_id + '\" data-item-id=\"' + item_id + '\"><td>(' + item_qty + ' x ' + formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val))+ ')</td><td style=\"text-align:right;\">'+ formatMoney(((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty))) +'</td></tr>';\n                var oprTr = '<tr class=\"bb row_' + item_id + '\" data-item-id=\"' + item_id + '\"><td>#'+(an-1)+' ' + item_name + ' (' + item_code + ')';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    oprTr += (comments[i] ? '<br> <b>*</b> <small>'+comments[i]+'</small>' : '');\n                }\n                oprTr += '</td><td>[ '+(item_was_ordered != 0 ? 'xxxx' : item_qty)+' ]</td></tr>';\n                $(\"#order-table\").append(oprTr);\n                $(\"#bill-table\").append(bprTr);\n            }\n        });\n\n        var ds = get('spos_discount') ? get('spos_discount') :\n        ($('#discount_val').val() ? $('#discount_val').val() : '0');\n        order_discount = parseFloat(ds);\n        if(ds.indexOf(\"%\") !== -1) {\n            var pds = ds.split(\"%\");\n            order_discount = parseFloat((total*parseFloat(pds[0]))/100);\n        }\n\n        var ts = get('spos_tax') ? get('spos_tax') :\n        ($('#tax_val').val() ? $('#tax_val').val() : '0');\n        order_tax = parseFloat(ts);\n        if(ts.indexOf(\"%\") !== -1) {\n            var pts = ts.split(\"%\");\n            order_tax = ((total-order_discount)*parseFloat(pts[0]))/100;\n        }\n\n        var g_total = total - parseFloat(order_discount) + parseFloat(order_tax);\n        grand_total = formatMoney(g_total);\n        $(\"#ds_con\").text('('+formatMoney(product_discount)+') '+formatMoney(order_discount));\n        $(\"#ts_con\").text(formatMoney(order_tax));\n        $(\"#total-payable\").text(grand_total);\n        $(\"#total\").text(formatMoney(total));\n        $(\"#count\").text((an-1)+' ('+formatMoney(count-1)+')');\n\n        if (Settings.remote_printing != 1) {\n\n            order_data.items = o_items;\n            bill_data.items = b_items;\n            var b_totals = '';\n            b_totals += printLine(lang.total+': '+ formatMoney(total)) +\"\\n\";\n            if(order_discount > 0 || product_discount > 0) {\n                b_totals += printLine(lang.discount+': '+ formatMoney(order_discount+product_discount)) +\"\\n\";\n            }\n            if (order_tax != 0) {\n                b_totals += printLine(lang.order_tax+': '+ formatMoney(order_tax)) +\"\\n\";\n            }\n            b_totals += printLine(lang.grand_total+': '+ formatMoney(g_total)) +\"\\n\";\n            if(Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - g_total);\n                b_totals += printLine(lang.rounding+': '+ formatMoney(rounding)) +\"\\n\";\n                b_totals += printLine(lang.total_payable+': '+ formatMoney(round_total)) +\"\\n\";\n            }\n            b_totals += \"\\n\"+ lang.total_items+': '+ (an - 1) + ' (' + (parseFloat(count) - 1) + ')' +\"\\n\";\n            bill_data.totals = b_totals;\n\n        } else {\n            var bill_totals = '';\n            bill_totals += '<tr class=\"bb\"><td>'+lang.total_items+'</td><td style=\"text-align:right;\">'+(an - 1) + ' (' + (parseFloat(count) - 1) + ')</td></tr>';\n            bill_totals += '<tr class=\"bb\"><td>'+lang.total+'</td><td style=\"text-align:right;\">'+formatMoney(total)+'</td></tr>';\n            if(order_discount > 0 || product_discount > 0) {\n                bill_totals += '<tr class=\"bb\"><td>'+lang.discount+'</td><td style=\"text-align:right;\">'+formatMoney(order_discount+product_discount)+'</td></tr>';\n            }\n            if (order_tax != 0) {\n                bill_totals += '<tr class=\"bb\"><td>'+lang.order_tax+'</td><td style=\"text-align:right;\">'+formatMoney(order_tax)+'</td></tr>';\n            }\n            bill_totals += '<tr class=\"bb\"><td>'+lang.grand_total+'</td><td style=\"text-align:right;\">'+formatMoney(g_total)+'</td></tr>';\n            if(Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - g_total);\n                bill_totals += '<tr class=\"bb\"><td>'+lang.rounding+'</td><td style=\"text-align:right;\">'+formatMoney(rounding)+'</td></tr>';\n                bill_totals += '<tr class=\"bb\"><td>'+lang.total_payable+'</td><td style=\"text-align:right;\">'+formatMoney(round_total)+'</td></tr>';\n            }\n            bill_totals += '<tr class=\"bb\"><td colspan=\"2\" style=\"text-align:center;\">'+lang.merchant_copy+'</td></tr>';\n            $('#bill-total-table').empty();\n            $('#bill-total-table').append(bill_totals);\n        }\n\n        if (Settings.display_kb == 1) { display_keyboards(); }\n        $('#add_item').focus();\n    }\n}\n\nfunction chr(i) {\n    return String.fromCharCode(i);\n}\n\n$(document).ready(function () {\n\n    $(document).on('click', '.no-results, #filter-suspended-sales', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    $('#susModal').on('shown.bs.modal', function (e) {\n        $('#reference_note').focus();\n    })\n\n    $('#filter-categories').hideseek({\n        nodata: lang.no_match_found\n    });\n\n    $(document).on('click', '.suspended_sales .dropdown-menu .header', function (e) {\n        e.stopPropagation();\n    });\n\n    $('#filter-suspended-sales').hideseek({\n        nodata: lang.no_match_found\n    });\n\n    $('#suspended_sales').on('shown.bs.dropdown', function () {\n        $('#filter-suspended-sales').focus();\n    });\n\n    $(document).on('click', '#update-note', function(){\n        var n = $('#snote').val();\n        store('spos_note', n);\n        $('#note').val(n);\n        $('#noteModal').modal('hide');\n    });\n    /* =============================\n    Edit Item Modal\n    ============================= */\n\n    $(\"#posTable\").on(\"click\", '.edit', function() {\n        var row = $(this).closest('tr');\n        var id = row.attr('id');\n        var item_id = row.attr('data-item-id');\n        var item = spositems[item_id];\n        //var unit_price = parseFloat(item.row.real_unit_price);\n        var unit_price = formatDecimal(row.find('.realuprice').val());\n        var net_price = unit_price;\n        var ds = item.row.discount ? item.row.discount : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf(\"%\") !== -1) {\n            var pds = ds.split(\"%\");\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((net_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax), pr_tax_val = 0, tax = '';\n        if (pr_tax !== null && pr_tax != 0) {\n            if(parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100+parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n        $('#proModalLabel').html('<a href=\"'+base_url+'/products/view/'+item_id+'\" data-toggle=\"ajax\">'+item.label+'</a>');\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n        $('#pro_tax_method').text('('+tax+')');\n        $('#row_id').val(row_id);\n        $('#item_id').val(item_id);\n        $('#nPrice').val(unit_price);\n        $('#nQuantity').val(item.row.qty);\n        $('#nDiscount').val(ds);\n        $('#nComment').val(item.row.comment);\n        $('#proModal').modal({backdrop:'static'});\n    });\n\n    $(document).on('change', '#nPrice, #nDiscount', function () {\n        var item_id = $('#item_id').val();\n        var unit_price = parseFloat($('#nPrice').val());\n        var net_price = unit_price;\n        var item = spositems[item_id];\n        var ds = $('#nDiscount').val() ? $('#nDiscount').val() : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf(\"%\") !== -1) {\n            var pds = ds.split(\"%\");\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((unit_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax), pr_tax_val = 0;\n        if (pr_tax !== null && pr_tax != 0) {\n            if(parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100+parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n    });\n\n    /* =============================\n    Edit Item Method\n    ============================= */\n     $(document).on('click', '#editItem', function () {\n        var item_id = $('#item_id').val();\n        var price = parseFloat($('#nPrice').val());\n        if(!is_valid_discount($('#nDiscount').val())) {\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        spositems[item_id].row.qty = parseFloat($('#nQuantity').val()),\n        spositems[item_id].row.real_unit_price = price,\n        spositems[item_id].row.comment = $('#nComment').val(),\n        spositems[item_id].row.discount = $('#nDiscount').val() ? $('#nDiscount').val() : '0',\n        localStorage.setItem('spositems', JSON.stringify(spositems));\n        $('#proModal').modal('hide');\n\n        loadItems();\n        return;\n    });\n\n    /* =============================\n    Row quantity change\n    ============================= */\n    $(document).on(\"change\", '.rquantity', function () {\n        var row = $(this).closest('tr');\n        if (!is_numeric($(this).val()) || $(this).val() == 0) {\n            loadItems();\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        var new_qty = parseFloat($(this).val()),\n        item_id = row.attr('data-item-id');\n        spositems[item_id].row.qty = new_qty;\n        localStorage.setItem('spositems', JSON.stringify(spositems));\n        loadItems();\n    });\n\n    $('#reset').click(function (e) {\n        if (count <= 1) {\n            return false;\n        }\n        if(protect_delete == 1) {\n            var boxd = bootbox.dialog({\n                title: lang.enter_pin_code,\n                closeButton: true,\n                message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                buttons: {\n                    danger: {\n                      label: lang.close,\n                      className: \"btn-default pull-left\",\n                      callback: function() { }\n                  },\n                  success: {\n                    label: \"<i class='fa fa-tick'></i> \"+lang.delete,\n                    className: \"btn-warning verify_pin\",\n                    callback: function () {\n                        var pos_pin = md5($('#pos_pin').val());\n                        if (pos_pin == Settings.pin_code) {\n                            if (get('spositems')) { remove('spositems'); }\n                            if (get('spos_tax')) { remove('spos_tax'); }\n                            if (get('spos_discount')) { remove('spos_discount'); }\n                            if (get('spos_customer')) { remove('spos_customer'); }\n                            window.location.href = base_url+\"pos\";\n                        } else {\n                            bootbox.alert(lang.wrong_pin);\n                        }\n                    }\n                }\n            }\n        });\n            boxd.on(\"shown.bs.modal\", function() {\n                if (Settings.display_kb == 1) { display_keyboards(); }\n                $( \"#pos_pin\" ).focus().keypress(function(e) {\n                    if (e.keyCode == 13) {\n                        e.preventDefault();\n                        $('.verify_pin').trigger('click');\n                        return false;\n                    }\n                });\n            });\n        } else {\n            bootbox.confirm(lang.r_u_sure, function (result) {\n                if (result) {\n                    if (get('spositems')) { remove('spositems'); }\n                    if (get('spos_tax')) { remove('spos_tax'); }\n                    if (get('spos_discount')) { remove('spos_discount'); }\n                    if (get('spos_customer')) { remove('spos_customer'); }\n                    window.location.href = base_url+\"pos\";\n                }\n            });\n        }\n    });\n\n    $('#print_order').click(function (e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#order-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preo').html('<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;\">' + order_data.info + order_data.items + '</pre>');\n                    html2canvas($('#order-data'), {\n                        onrendered: function(canvas) {\n                            // Canvas2Image.saveAsPNG(canvas);\n                            var img = canvas.toDataURL().split(',')[1];\n                            $.post(base_url+'pos/receipt_img', {img: img, spos_token: csrf_hash});\n                        }\n                    });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url+'pos/p/order', form);\n                }\n            } else {\n                printOrder(order_data);\n            }\n        }\n        setTimeout(function() { $('#order-data').hide(); }, 500);\n        return false;\n    });\n\n    $('#print_bill').click(function (e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#bill-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preb').html('<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;\">' + bill_data.info + bill_data.items + \"\\n\" + bill_data.totals + '</pre>');\n                    html2canvas($('#bill-data'), {\n                        onrendered: function(canvas) {\n                            var img = canvas.toDataURL().split(',')[1];\n                            $.post(base_url+'pos/receipt_img', {img: img, spos_token: csrf_hash});\n                        }\n                    });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url+'pos/p/bill', form);\n                }\n            } else {\n                printBill(bill_data);\n            }\n        }\n        setTimeout(function() { $('#bill-data').hide(); }, 500);\n        return false;\n    });\n\n    $(\"#updateDiscount\").click(function() {\n        var ds = $('#get_ds').val() ? $('#get_ds').val() : '0';\n        var apply_to = $('input[name=apply_to]:checked').val();\n        if (ds.length != 0) {\n        if (apply_to == 'order') {\n            $('#discount_val').val(ds);\n            store('spos_discount', ds);\n            if(ds.indexOf(\"%\") !== -1) {\n                var pds = ds.split(\"%\");\n\n                    order_discount = (total*parseFloat(pds[0]))/100;\n                    order_tax = calTax();\n                    var g_total = total + order_tax - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ds_con\").text('('+formatMoney(product_discount)+') '+formatMoney(order_discount));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n\n            } else {\n\n                    order_discount = ds;\n                    order_tax = calTax();\n                    var g_total = (total + order_tax) - parseFloat(order_discount);\n                    grand_total = parseFloat(g_total);\n                    $(\"#ds_con\").text('('+formatMoney(product_discount)+') '+formatMoney(order_discount));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n            }\n        } else if (apply_to == 'products') {\n            var items = {};\n            spositems = JSON.parse(get('spositems'));\n            $.each(spositems, function () {\n                this.row.discount = ds;\n            });\n            store('spositems', JSON.stringify(spositems));\n        }\n        loadItems();\n        $('#dsModal').modal('hide');\n    }\n    });\n\n    $(\"#add_discount\").click(function() {\n        var dval = $('#discount_val').val();\n        $('#get_ds').val(dval);\n        $('#dsModal').modal({backdrop:'static'});\n        return false;\n    });\n    $('#dsModal').on('shown.bs.modal', function () {\n        $('#get_ds').focusToEnd();\n    });\n\n    $(\"#updateTax\").click(function() {\n        var ts = $('#get_ts').val();\n        if (ts.length != 0) {\n            $('#tax_val').val(ts);\n            store('spos_tax', ts);\n            if(ts.indexOf(\"%\") !== -1) {\n                var pts = ts.split(\"%\");\n                if(! isNaN(pts[0])){\n                    order_tax = ((total-order_discount)*parseFloat(pts[0]))/100;\n                    var g_total = (total + order_tax) - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text(formatMoney(order_tax));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0'); $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text('0');\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                }\n            } else {\n                if(! isNaN(ts) && ts != 0){\n                    order_tax = ts;\n                    var g_total = (total + parseFloat(ts)) - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text(formatMoney(order_tax));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0'); $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text('0');\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                }\n            }\n            $('#tsModal').modal('hide');\n        }\n    });\n\n    $(\"#add_tax\").click(function() {\n        var tval = $('#tax_val').val();\n        $('#get_ts').val(tval);\n        $('#tsModal').modal({backdrop:'static'});\n        return false;\n    });\n    $('#tsModal').on('shown.bs.modal', function () {\n        $('#get_ts').focusToEnd();\n    });\n    $('#noteModal').on('shown.bs.modal', function () {\n        $('#snote').focusToEnd();\n    });\n\n    $(document).on('click', '.product', function (e) {\n        code = $(this).val();\n        $.ajax({\n            type: \"get\",\n            url: base_url+'pos/get_product/'+code,\n            dataType: \"json\",\n            success: function (data) {\n                if (data !== null) {\n                    add_invoice_item(data);\n                } else {\n                    bootbox.alert(lang.no_match_found);\n                }\n            }\n        });\n    });\n\n    $(document).on('click', '.category', function () {\n        var cid = $(this).attr('id');\n        if (cat_id != cid) {\n            cat_id = cid;\n            $.ajax({\n                type: \"get\",\n                url: base_url+'pos/ajaxproducts',\n                data: {category_id: cat_id, tcp: 1},\n                dataType: \"json\",\n                success: function (data) {\n                    p_page = 'n';\n                    // $('#categories-list').addClass('control-sidebar-open');\n                    //ocat_id = cat_id;\n                    tcp = data.tcp;\n                    $('.items').html(data.products);\n                    $('.category').removeClass('active');\n                    $('#' + cat_id).addClass('active');\n                    nav_pointer();\n                }\n            });\n        }\n        return false;\n    });\n    $('#category-' + cat_id).addClass('active');\n\n    $('#next').click(function () {\n        if (p_page == 'n') { p_page = 0; }\n        p_page += pro_limit;\n        if (tcp >= pro_limit && p_page < tcp) {\n            $.ajax({\n                type: \"get\",\n                url: base_url+'pos/ajaxproducts',\n                data: {category_id: cat_id, per_page: p_page},\n                dataType: \"html\",\n                success: function (data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                }\n            });\n        } else {\n            p_page -= pro_limit;\n        }\n    });\n\n    $('#previous').click(function () {\n        if (p_page == 'n') { p_page = 0; }\n        if (p_page != 0) {\n            p_page -= pro_limit;\n            if (p_page == 0) { p_page = 'n'; }\n            $.ajax({\n                type: \"get\",\n                url: base_url+'pos/ajaxproducts',\n                data: {category_id: cat_id, per_page: p_page},\n                dataType: \"html\",\n                success: function (data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                }\n            });\n        }\n    });\n\n    $(\"#add_item\").autocomplete({\n        source: base_url+'pos/suggestions',\n        minLength: 1,\n        autoFocus: false,\n        delay: 200,\n        response: function (event, ui) {\n            if ($(this).val().length >= 16 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function () {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            }\n            else if (ui.content.length == 1 && ui.content[0].id != 0) {\n                ui.item = ui.content[0];\n                $(this).data('ui-autocomplete')._trigger('select', 'autocompleteselect', ui);\n                $(this).autocomplete('close');\n            }\n            else if (ui.content.length == 1 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function () {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            }\n        },\n        select: function (event, ui) {\n            event.preventDefault();\n            if (ui.item.id !== 0) {\n                var row = add_invoice_item(ui.item);\n                if (row)\n                    $(this).val('');\n            } else {\n                bootbox.alert(lang.no_match_found);\n            }\n        }\n    });\n\n    $('#add_item').bind('keypress', function (e) {\n        if (e.keyCode == 13) {\n            e.preventDefault();\n            $(this).autocomplete(\"search\");\n        }\n    });\n\n    $('#add_item').focus();\n    $('#gccard_no').inputmask(\"9999 9999 9999 9999\");\n    $('#gift_card_no').inputmask(\"9999 9999 9999 9999\");\n    $(\"#gcexpiry\").inputmask(\"yyyy-mm-dd\", {\"placeholder\": \"yyyy-mm-dd\"});\n    $('#genNo').click(function () {\n        var no = generateCardNo();\n        $(this).parent().parent('.input-group').children('input').val(no);\n        return false;\n    });\n\n    $(document).on('click', '#sellGiftCard', function (e) {\n        if (count == 1) {\n            spositems = {};\n        }\n        $('#gcModal').modal({backdrop:'static'});\n     });\n\n    $(document).on('click', '#addGiftCard', function (e) {\n        var mid = 0,\n        gccode = $('#gccard_no').val(),\n        gcname = $('#gcname').val(),\n        gcvalue = $('#gcvalue').val(),\n        gcprice = parseFloat($('#gcprice').val());\n        gcexpiry = $('#gcexpiry').val();\n        if(gccode == '' || gcvalue == '' || gcprice == '' || gcvalue == 0 || gcprice == 0) {\n            $('#gcerror').text(lang.file_required_fields);\n            $('.gcerror-con').show();\n            return false;\n        }\n        var gc_data = new Array();\n        gc_data[0] = gccode;\n        gc_data[1] = gcvalue;\n        gc_data[2] = gcexpiry;\n\n        $.ajax({\n            type: 'get',\n            url: base_url+'gift_cards/sell_gift_card',\n            dataType: \"json\",\n            data: { gcdata: gc_data },\n            success: function (data) {\n                if(data.result === 'success') {\n                    spositems[mid] = {\"id\": mid, \"item_id\": mid, \"label\": gcname + ' (' + gccode + ')', \"row\": {\"id\": mid, \"code\": gccode, \"name\": gcname, \"quantity\": 1, \"price\": gcprice, \"real_unit_price\": gcprice, \"tax\": 0, \"qty\": 1, \"type\": \"manual\", \"discount\": \"0\", \"comment\": \"\"}};\n                    store('spositems', JSON.stringify(spositems));\n                    loadItems();\n                    $('#gcModal').modal('hide');\n                    $('#gccard_no').val('');\n                    $('#gcvalue').val('');\n                    $('#gcprice').val('');\n                } else {\n                    $('#gcerror').text(data.message);\n                    $('.gcerror-con').show();\n                }\n            }\n        });\n    });\n\n    // $('#opModal').bind().on('click', 'a', function(){\n    //     var pg = $.url($(this).attr(\"href\")).param(\"per_page\");\n    //     $.get( base_url+'pos/ob_page&per_page='+pg, function( data ) {\n    //         $( \".html_con\" ).html( data.pd );\n    //         $( \".page_con\" ).html( data.page );\n    //     }, \"json\");\n\n    //     return false;\n    // });\n\n\n        var pwacc = false;\n        $(document).on('click', '.posdel', function () {\n            var row = $(this).closest('tr');\n            var item_id = row.attr('data-item-id');\n            if(protect_delete == 1) {\n                var boxd = bootbox.dialog({\n                    title: lang.enter_pin_code,\n                    closeButton: true,\n                    message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                    buttons: {\n                        danger: {\n                          label: lang.close,\n                          className: \"btn-default pull-left\",\n                          callback: function() { }\n                        },\n                        success: {\n                            label: \"<i class='fa fa-tick'></i> \"+lang.delete,\n                            className: \"btn-warning verify_pin\",\n                            callback: function () {\n                                var pos_pin = md5($('#pos_pin').val());\n                                if(pos_pin == Settings.pin_code) {\n                                    delete spositems[item_id];\n                                    row.remove();\n                                    if(spositems.hasOwnProperty(item_id)) { } else {\n                                        localStorage.setItem('spositems', JSON.stringify(spositems));\n                                        loadItems();\n                                    }\n                                } else {\n                                    bootbox.alert(lang.wrong_pin);\n                                }\n                            }\n                        }\n                    }\n                });\n            boxd.on(\"shown.bs.modal\", function() {\n                if (Settings.display_kb == 1) { display_keyboards(); }\n                $( \"#pos_pin\" ).focus().keypress(function(e) {\n                    if (e.keyCode == 13) {\n                        e.preventDefault();\n                        $('.verify_pin').trigger('click');\n                        return false;\n                    }\n                });\n            });\n        } else {\n            delete spositems[item_id];\n            row.remove();\n            if(spositems.hasOwnProperty(item_id)) { } else {\n                localStorage.setItem('spositems', JSON.stringify(spositems));\n                loadItems();\n            }\n        }\n        return false;\n    });\n\n    $('#suspend').click(function () {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n            $('#susModal').modal({backdrop:'static'});\n        }\n    });\n\n    $('#suspend_sale').click(function () {\n        ref = $('#reference_note').val();\n        if (!ref || ref == '') {\n            bootbox.alert(lang.type_reference_note);\n            return false;\n        } else {\n            suspend = $('<span></span>');\n            if (sid !== 0) {\n                suspend.html('<input type=\"hidden\" name=\"delete_id\" value=\"'+sid+'\" /><input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' + ref + '\" />');\n            } else {\n                suspend.html('<input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' + ref + '\" />');\n            }\n            suspend.appendTo(\"#hidesuspend\");\n            $('#pos-sale-form').submit();\n        }\n    });\n\n    $('#payment').click(function () {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n\n            if (sid) {\n            suspend = $('<span></span>');\n            suspend.html('<input type=\"hidden\" name=\"delete_id\" value=\"'+sid+'\" />');\n            suspend.appendTo(\"#hidesuspend\");\n            }\n\n            gtotal = formatDecimal(total - order_discount + order_tax);\n            if(Settings.rounding != 0) {\n                round_total = roundNumber(gtotal, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - gtotal);\n                $('#twt').text(formatMoney(round_total) + ' (' + formatMoney(rounding) + ')');\n                $('#quick-payable').text(round_total);\n            } else {\n                $('#twt').text(formatMoney(gtotal));\n                $('#quick-payable').text(gtotal);\n            }\n            $('#item_count').text((an-1)+' ('+(count-1)+')');\n            $(\"#order_quantity\").val(count-1);\n            $(\"#order_items\").val(an-1);\n            $('#balance').text('0.00');\n            $('#payModal').modal({backdrop:'static'});\n\n        }\n    });\n    $('#payModal').on('shown.bs.modal', function (e) {\n        $('#amount').focus().val(0);\n        $('#quick-payable').click();\n    });\n    $('#payModal').on('hidden.bs.modal', function (e) {\n        $('#amount').val('').change();\n    });\n\n    $('#amount').change(function(e) {\n        var total_paying = $(\".amount\").val();\n        $('#total_paying').text(formatMoney(total_paying));\n        if(Settings.rounding != 0) {\n            $('#balance').text(formatMoney(total_paying - round_total));\n            $('#balance_val').val(formatDecimal(total_paying - round_total));\n            total_paid = total_paying;\n            grand_total = round_total;\n        } else {\n            $('#balance').text(formatMoney(total_paying - gtotal));\n            $('#balance_val').val(formatDecimal(total_paying - gtotal));\n            total_paid = total_paying;\n            grand_total = gtotal;\n        }\n    });\n\n    $('#add-customer').click(function () {\n        $('#customerModal').modal({backdrop:'static'});\n    });\n\n    $('#payModal').on('change', '#paid_by', function () {\n        $('#clear-cash-notes').click();\n        $('#amount').val(grand_total);\n        var p_val = $(this).val();\n        $('#paid_by_val').val(p_val);\n        var gtotal = formatDecimal(total - order_discount + order_tax);\n        if(Settings.rounding != 0) {\n            var rounded_total = formatDecimal(roundNumber(gtotal, parseInt(Settings.rounding)));\n        } else {\n            var rounded_total = formatDecimal(gtotal);\n        }\n        $('#rpaidby').val(p_val);\n        if (p_val == 'gift_card') {\n            $('.gc').slideDown();\n            $('.ngc').slideUp('fast');\n            setTimeout(function(){ $('#gift_card_no').focus(); }, 10);\n            $('#amount').attr('readonly', true);\n        } else {\n            $('.ngc').slideDown();\n            $('.gc').slideUp('fast');\n            $('#gc_details').html('');\n            $('#amount').attr('readonly', false);\n        }\n        if (p_val == 'cash' || p_val == 'other') {\n            $('.pcash').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcc').slideUp('fast');\n            setTimeout(function(){ $('#amount').focus(); }, 10);\n        } else if (p_val == 'CC' || p_val == 'stripe') {\n            $('.pcc').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function(){ $('#swipe').val('').focus(); }, 10);\n        } else if (p_val == 'cheque') {\n            $('.pcheque').slideDown();\n            $('.pcc').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function(){ $('#cheque_no').focus(); }, 10);\n        } else {\n            $('.pcheque').hide();\n            $('.pcc').hide();\n            $('.pcash').hide();\n        }\n    });\n\n    $(document).on('change', '.gift_card_no', function () {\n        var cn = $(this).val() ? $(this).val() : '';\n        if (cn != '') {\n            $.ajax({\n                type: \"get\", async: false,\n                url: base_url + \"pos/validate_gift_card/\" + cn,\n                dataType: \"json\",\n                success: function (data) {\n                    if (data === false || data.balance < 0) {\n                        $('#gift_card_no').parent('.form-group').addClass('has-error');\n                        bootbox.alert(lang.incorrect_gift_card);\n                    } else {\n                        $('#gc_details').html(lang.card_no+': ' + data.card_no + '<br>'+lang.value+': ' + data.value + ' - '+lang.balance+': ' + data.balance);\n                        $('#gift_card_no').parent('.form-group').removeClass('has-error');\n                        var paying = (gtotal > data.balance) ? data.balance : gtotal;\n                        $('#amount_val').val(paying);\n                        $('#amount').val(paying);\n                    }\n                }\n            });\n        }\n        return false;\n    });\n\n    $(document).on('click', '#quick-payable', function () {\n        $('#clear-cash-notes').click();\n        $(this).append('<span class=\"badge\">1</span>');\n        $('#amount').val(grand_total);\n    });\n\n    $(document).on('click', '.quick-cash', function () {\n        if ($('#quick-payable').find('span.badge').length) {\n            $('#clear-cash-notes').click();\n        }\n        var $quick_cash = $(this);\n        var amt = $quick_cash.contents().filter(function () {\n            return this.nodeType == 3;\n        }).text();\n        var th = Settings.thousands_sep == 0 ? '' : Settings.thousands_sep;\n        var $pi = $('#amount');\n        amt = formatDecimal(amt.split(th).join(\"\")) * 1 + $pi.val() * 1;\n        $pi.val(formatDecimal(amt)).change().focus();\n        var note_count = $quick_cash.find('span');\n        if (note_count.length == 0) {\n            $quick_cash.append('<span class=\"badge\">1</span>');\n        } else {\n            note_count.text(parseInt(note_count.text()) + 1);\n        }\n    });\n\n    $(document).on('click', '#clear-cash-notes', function () {\n        $('.quick-cash').find('.badge').remove();\n        $('#amount').val('').change().focus();\n    });\n\n    $('#payModal').on('change', '#amount, #paid_by', function (e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('blur', '#amount', function (e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('select2-close', '#paid_by', function (e) {\n        $('#paid_by_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_no', function (e) {\n        $('#cc_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_holder', function (e) {\n        $('#cc_holder_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#gift_card_no', function (e) {\n        $('#paying_gift_card_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_month', function (e) {\n        $('#cc_month_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_year', function (e) {\n        $('#cc_year_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_type', function (e) {\n        $('#cc_type_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_cvv2', function (e) {\n        $('#cc_cvv2_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#cheque_no', function (e) {\n        $('#cheque_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#payment_note', function (e) {\n        $('#payment_note_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#note', function (e) {\n        var n = $(this).val();\n        store('spos_note', n);\n        $('#spos_note').val(n);\n    });\n    if(spos_note = get('spos_note')) {\n        $('#note').val(spos_note);\n        $('#snote').val(spos_note);\n    }\n    $('#spos_customer').change( function (e) {\n        store('spos_customer', $(this).val());\n    });\n    if(spos_customer = get('spos_customer')) {\n        $('#spos_customer').select2('val', spos_customer);\n    }\n\n    $('.treeview').hover(function(e) {\n        var wh = $(document).height();\n        var top = $(this).offset().top;\n        var menu = $(this).find('.treeview-menu');\n        var menuh = menu.height() + 44;\n        if ((wh-top) < menuh) {\n            $(this).find('a').children('span').addClass('popup')\n            menu.addClass('popup');\n        } else {\n            $(this).find('a').children('span').removeClass('popup')\n            menu.removeClass('popup');\n        }\n    });\n\n    $('body').click(function(e) {\n        if (!$(e.target).hasClass('sidebar-icon') && !$(e.target).hasClass('sb') && $('#categories-list').hasClass('control-sidebar-open')) {\n            $('#categories-list').removeClass('control-sidebar-open');\n        }\n    });\n\n    $('#submit-sale').click(function() {\n        $('#total_items').val(an - 1);\n        $('#total_quantity').val(count - 1);\n        // console.log($('#amount_val').val());\n        $('#submit').click();\n    });\n\n    var hold_ref = $('#hold_ref').val();\n    $('#hold_ref').change(function () {\n        hold_ref = $(this).val();\n        $('#reference_note').val(hold_ref);\n    });\n    $('#reference_note').change(function () {\n        hold_ref = $(this).val();\n        $('#hold_ref').val(hold_ref);\n    });\n\n    $('#suspend_sale').click(function() {\n        if($('#reference_note').val()) {\n            $('#hold_ref').val($('#reference_note').val());\n            $('#total_items').val(an - 1);\n            $('#total_quantity').val(count - 1);\n            $('#submit').click();\n        }\n        return false;\n    });\n\n    $(\"#customer-form\").on(\"submit\", function(e) {\n        e.preventDefault();\n        $.ajax({\n            type: \"post\",\n            url: base_url+'customers/add',\n            data: $( this ).serialize(),\n            dataType: \"json\",\n            success: function(res) {\n                if(res.status == 'success') {\n                    $('#spos_customer').append($(\"<option></option>\").attr(\"value\",res.id).text(res.val));\n                    $('#spos_customer').select2('val', res.id);\n                    $('#customerModal').modal('hide');\n                } else {\n                    $('#c-alert').html(res.msg);\n                    $('#c-alert').show();\n                }\n            },\n            error: function(){\n                bootbox.alert(lang.customer_request_failed);\n                return false;\n            }\n        });\n        return false;\n    });\n\n    $('#customerModal').on('hidden.bs.modal', function (e) {\n        $('#c-alert').hide();\n        $('#cname').val('');\n        $('#cemail').val('');\n        $('#cphone').val('');\n        $('#cf1').val('');\n        $('#cf2').val('');\n    });\n\n});\n\nfunction display_keyboards() {\n    if( ! jQuery.browser.mobile) {\n        $('.kb-text').keyboard({\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'focus',\n            usePreview: false,\n            // layout: 'qwerty',\n            layout: 'custom',\n            display: {\n                'bksp': \"\\u2190\",\n                'accept': 'return',\n                'default': 'ABC',\n                'meta1': '123',\n                'meta2': '#+='\n            },\n            customLayout: {\n                'default': [\n                    'q w e r t y u i o p {bksp}',\n                    'a s d f g h j k l {enter}',\n                    '{s} z x c v b n m , . {s}',\n                    '{meta1} {space} {cancel} {accept}'\n                ],\n                'shift': [\n                    'Q W E R T Y U I O P {bksp}',\n                    'A S D F G H J K L {enter}',\n                    '{s} Z X C V B N M / ? {s}',\n                    '{meta1} {space} {meta1} {accept}'\n                ],\n                'meta1': [\n                    '1 2 3 4 5 6 7 8 9 0 {bksp}',\n                    '- / : ; ( ) \\u20ac & @ {enter}',\n                    '{meta2} . , ? ! \\' \" {meta2}',\n                    '{default} {space} {default} {accept}'\n                ],\n                'meta2': [\n                    '[ ] { } # % ^ * + = {bksp}',\n                    '_ \\\\ | &lt; &gt; $ \\u00a3 \\u00a5 {enter}',\n                    '{meta1} ~ . , ? ! \\' \" {meta1}',\n                    '{default} {space} {default} {accept}'\n                ]}\n        });\n\n        $('.kb-pad').keyboard({\n            restrictInput: true,\n            preventPaste: true,\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'click',\n            usePreview: false,\n            layout: 'costom',\n            display: {\n                'b': '\\u2190:Backspace'\n            },\n            customLayout: {\n                'default': [\n                    '1 2 3 {b}',\n                    '4 5 6 . {clear}',\n                    '7 8 9 0 %',\n                    '{accept} {cancel}'\n                ]\n            }\n        });\n    }\n}\n\nfunction calTax() {\n    var ts = get('spos_tax') ? get('spos_tax') : $('#tax_val').val();\n    if(ts.indexOf(\"%\") !== -1) {\n        var pts = ts.split(\"%\");\n        order_tax = ((total-order_discount)*parseFloat(pts[0]))/100;\n        $(\"#ts_con\").text(formatMoney(order_tax));\n    } else {\n        order_tax = parseFloat(ts);\n        $(\"#ts_con\").text(formatMoney(order_tax));\n    }\n    return order_tax;\n}\n\nfunction nav_pointer() {\n    var pp = p_page == 'n' ? 0 : p_page;\n    (pp == 0) ? $('#previous').attr('disabled', true) : $('#previous').attr('disabled', false);\n    ((pp+pro_limit) > tcp) ? $('#next').attr('disabled', true) : $('#next').attr('disabled', false);\n}\n\nfunction Popup(data) {\n    var mywindow = window.open('', 'spos_print', 'height=500,width=300');\n    mywindow.document.write('<!DOCTYPE html><html><head><title>Print</title>');\n    mywindow.document.write('<link rel=\"stylesheet\" href=\"'+assets+'bootstrap/css/bootstrap.min.css\" type=\"text/css\" />');\n    mywindow.document.write('<style>a {color: #333;} #totaltbl td, #totaltbl th { vertical-align: middle; }</style>');\n    mywindow.document.write('</head><body >');\n    mywindow.document.write(data);\n    mywindow.document.write('</body></html>');\n    mywindow.print();\n    mywindow.close();\n    return true;\n}\n\n$(document).ready(function($) {\n    window.setTimeout(function() {\n        $('.alerts').slideUp();\n    }, 15000);\n    $('.alerts').on('click',function(e) {\n        $(this).slideUp();\n    });\n    $('#list-table-div').slimScroll({start: 'bottom'});\n    $('#category-sidebar-menu').slimScroll({width: '100%'});\n    $('.items').slimScroll({});\n});\n\nfunction posScreen() {\n    var wh = $(window).height(),\n    total_dh = $('#totaldiv').height(),\n    buttons_dh = $('.botbuttons').height(),\n    left_top_dh = $('#lefttop').outerHeight();\n    var items_dh = wh-120, list_table_dh = wh-185-left_top_dh-total_dh-buttons_dh;\n    $('#right-col').height(wh-100);\n    $('.items').height((items_dh > 400 ? items_dh : 400));\n    $('#list-table-div').height(list_table_dh);\n}\n\nfunction printLine(str) {\n    var size = parseInt(Settings.char_per_line)-4;\n    var len = str.length;\n    var res = str.split(\":\");\n    var newd = res[0];\n    for(i=1; i<(size-len); i++) {\n        newd += \" \";\n    }\n    newd += res[1];\n    return newd;\n}\n\n$(window).bind(\"resize\", posScreen);\n\nfunction read_card() {\n\n}\n\n$.extend($.keyboard.keyaction, {\n    enter : function(base) {\n        if (base.$el.is(\"textarea\")){\n            base.insertText('\\r\\n');\n        } else {\n            base.accept();\n        }\n    }\n});\n\n$(document).ready(function() {\n    posScreen();\n    if (Settings.display_kb == 1) { display_keyboards(); }\n    nav_pointer();\n    loadItems();\n    read_card();\n\n    $('.swipe').keypress( function (e) {\n        var TrackData = $(this).val() ? $(this).val() : '';\n        if(TrackData != '') {\n            if (e.keyCode == 13) {\n                e.preventDefault();\n                var p = new SwipeParserObj(TrackData);\n\n                if(p.hasTrack1)\n                {\n\n                    var CardType = null;\n                    var ccn1 = p.account.charAt(0);\n                    if(ccn1 == 4)\n                        CardType = 'Visa';\n                    else if(ccn1 == 5)\n                        CardType = 'MasterCard';\n                    else if(ccn1 == 3)\n                        CardType = 'Amex';\n                    else if(ccn1 == 6)\n                        CardType = 'Discover';\n                    else\n                        CardType = 'Visa';\n\n                    $('#pcc_no').val(p.account).change();\n                    $('#pcc_holder').val(p.account_name).change();\n                    $('#pcc_month').val(p.exp_month).change();\n                    $('#pcc_year').val(p.exp_year).change();\n                    $('#pcc_cvv2').val('');\n                    $('#pcc_type').select2('val', CardType);\n\n                } else {\n                    $('#pcc_no').val('').change();\n                    $('#pcc_holder').val('').change();\n                    $('#pcc_month').val('').change();\n                    $('#pcc_year').val('').change();\n                    $('#pcc_cvv2').val('').change();\n                    $('#pcc_type').val('').change();\n                }\n\n                $('#pcc_cvv2').focus();\n            }\n        }\n\n    }).blur(function (e) {\n        $(this).val('');\n    }).focus( function (e) {\n        $(this).val('');\n    });\n\n    $(document).on('blur', '#pcc_no', function () {\n        var cn = $(this).val();\n        var ccn1 = cn.charAt(0);\n        if(ccn1 == 4)\n            CardType = 'Visa';\n        else if(ccn1 == 5)\n            CardType = 'MasterCard';\n        else if(ccn1 == 3)\n            CardType = 'Amex';\n        else if(ccn1 == 6)\n            CardType = 'Discover';\n        else\n            CardType = 'Visa';\n\n        $('#pcc_type').select2('val', CardType);\n    });\n\n    $('.modal').on('hidden.bs.modal', function() {\n        $(this).removeData('bs.modal');\n    });\n    $('#clearLS').click(function(event) {\n        bootbox.confirm(lang.r_u_sure, function(result) {\n            if(result == true) {\n                localStorage.clear();\n                location.reload();\n            }\n        });\n        return false;\n    });\n\n    if(Settings.focus_add_item != '') {\n        shortcut.add(Settings.focus_add_item, function() { $(\"#add_item\").focus(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.add_customer != '') {\n        shortcut.add(Settings.add_customer, function() { $(\"#add-customer\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.toggle_category_slider != '') {\n        shortcut.add(Settings.toggle_category_slider, function() { $('[data-toggle=\"control-sidebar\"]').trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.cancel_sale != '') {\n        shortcut.add(Settings.cancel_sale, function() { $(\"#reset\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.suspend_sale != '') {\n       shortcut.add(Settings.suspend_sale, function() { $(\"#suspend\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.print_order != '') {\n       shortcut.add(Settings.print_order, function() { $(\"#print_order\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.print_bill != '') {\n       shortcut.add(Settings.print_bill, function() { $(\"#print_bill\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.finalize_sale != '') {\n       shortcut.add(Settings.finalize_sale, function() { $(\"#payment\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.today_sale != '') {\n       shortcut.add(Settings.today_sale, function() { $(\"#today_sale\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.open_hold_bills != '') {\n       shortcut.add(Settings.open_hold_bills, function() { $(\"#opened_bills\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.close_register != '') {\n       shortcut.add(Settings.close_register, function() { $(\"#close_register\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n\n});\n$.fn.focusToEnd = function() { return this.each(function() { var v = $(this).val(); $(this).focus().val(\"\").val(v); }); };\n$.ajaxSetup ({ cache: false, headers: { \"cache-control\": \"no-cache\" } });\n"]}